---
title: "Homework2.Rmd"
author: "Daniel Wu"
date: "2025-01-14"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
setwd("/Users/danielwu/Documents/Study/SDS 315")
profs <- read_csv("profs.csv")
bikes <- read_csv("bikeshare.csv")
capmetro_UT <- read_csv("capmetro_UT.csv")
billb <- read_csv("billboard.csv")
```

# Problem 1


## Part A
```{r}
ggplot(profs) + geom_histogram(aes(x=eval)) + theme_classic()
```

This histogram shows the distribution of course evaluation scores

The distribution seems to be skewed towards 4 out of 5 points, meaning that a lot of students were quite satisfied with their professors.

## Part B
```{r}
ggplot(profs) + geom_boxplot(aes(x=eval)) + facet_wrap(~native) + theme_classic() + labs(
    title = "Course Evaluations Among Professors who are Native vs. Non-native English Speakers",
    x = "Evaluations",
    y = "Count"
  )
```

Distriution of course evaluation scores (eval) among professors who are native or non-native English speakers

According to the box plots, the distribution of ratings among professors who are non-native vs. native professors are similar. However, there are outliers in which students gave low ratings to some professors who are native speakers. However, this can be due to other personal reasons since the difference is not very significant. Therefore, nativeness in English is not a major determinant of course evaluations.

## Part C
```{r}
ggplot(profs) + geom_histogram(aes(x=eval)) + facet_wrap(~gender) + theme_classic() + labs(
    title = "Distributions of Course Evaluations Among Professors of Different Genders",
    x = "Evaluations",
    y = "Count"
  ) 
```

Distribution of course evaluation scores (eval) among female and male professors

According to the two histograms, the distribution of course evaluations among female and male professors look very similar. However, there is apparently a greater count of male professors when compared to female professors.

## Part D
```{r}
ggplot(profs) + geom_jitter(aes(x=beauty, y = eval)) + theme_classic() + labs(
    title = "Relationship Between Beauty and Course Evaluations",
    x = "Beauty",
    y = "Course Evaluations"
  ) 
```

Relationship between beauty and the evaluations core of professors (eval)

This suggests that there is some positive relationship between beauty and course evaluations of professors.


# Problem 2

## Plot A
```{r}
rentals <- group_by(bikes, hr) %>%
  summarise(avg_rentals = mean(total))
ggplot(rentals) + geom_line(aes(x=hr, y = avg_rentals)) + theme_classic() + labs(
    title = "Total Number of Bike Rentals Throughout Different Hours of the Day",
    x = "Hour of the Day",
    y = "Number of Rentals"
  ) 
```

The number of bike rentals across different hours of the day

This line graph shows that in the early hours (hr) of the day, there are not a lot of bike rentals (total). However, as 8 am approaches, there is an increase in bike rentals and it peaks at around 8 am, but at around 9 am, bike rentals started to decrease again. At around 5 or 6 pm, bike rentals increase sharply again, reaching a peak at around 5:30 pm. After that time, bike rentals sharply decrease again. This shows that some people tend to rent bikes for commuting purposes, and people rarely commute in the early hours of the day, during working hours, or after the evening hours.

## Plot B
```{r}
working <- group_by(bikes, hr, workingday) %>%
  summarize(avg_rentals = mean(total))
ggplot(working) + geom_line(aes(x=hr, y = avg_rentals)) + facet_wrap(~workingday) + theme_classic() + labs(
    title = "Average Number of Bike Rentals Throughout Different Hours of the Day Among Weekdays or Weekends",
    x = "Hour of the Day",
    y = "Average Number of Rentals")
```

The average number of bike rentals during the different hours of the day according to if it is a weekday or weekend.

During the weekends or holidays (0), not a lot of people rent bikes during the very early hours of the day, but at around 7 or 8 am, the average numbers rapidly increase, reaching a peak at around 11 am. However, at around 5 pm, the average numbers sharply decrease again. This shows that whenever it is not a working day, some people tend to rent bikes to pass free time. During the weekdays (1), at around 8 am, the average number of rentals rise rapidly until it reaches a peak at around 9 am, and then it decreases rapidly. At around 5 pm, the average number of rentals rises rapidly again until a new peak is reached, and then it decreases after around 6 pm.

## Plot C
```{r}
nine_am = filter(bikes, hr == 9)
rents <- group_by(nine_am, total, weathersit, workingday) %>%
  summarise(avg_rents = mean(total), .groups = "drop")
ggplot(rents) + geom_col(aes(x = weathersit, y = avg_rents)) + facet_wrap(~workingday) + theme_classic() + labs(title = "Average Number of Bike Rentals in Different Weather Conditions According to If It Is a Workday")
```

The average number of bike rentals during the different weather conditions (1, 2, 3)

According to the bar plots, first of all, weather has a pretty significant effect on bike rentals (total). When the weather is good (eg. clear, sunny, partly cloudy) (1), there are many people who rent bikes. However, when the weather is poor (eg.thunderstorms/snow/fog) (3), there is a lot less people who rented bikes. This relationship is demonstrated on both weekdays (1) and weekends (0). However, the total number of people who rented bikes also increased when it is a weekday, furthering showing that some people primarily rely on bikeshare services to commute to work.

# Problem 3
```{r}
capmetro_UT = mutate(capmetro_UT,
day_of_week = factor(day_of_week,
levels=c("Mon", "Tue", "Wed","Thu", "Fri", "Sat", "Sun")),
month = factor(month,
levels=c("Sep", "Oct","Nov")))
```



## Part 1
```{r}
boardings <- group_by(capmetro_UT, hour_of_day, day_of_week, month) %>%
  summarise(avg_boardings = mean(boarding), .groups = "drop")

ggplot(boardings) + geom_line(aes(x = hour_of_day, y = avg_boardings, color = month)) + facet_wrap(~day_of_week) + theme_classic() + labs(
    title = "Average Number of Boardings at Different Hours of the Day in Different Months among the Day of the Week",
    x = "Hour of the Day",
    y = "Number of Rentals")
```

Average boardings among September, October, and November by day of the week. 

The hour of peak average boardings is usually between 3 and 5 pm (15 and 17), meaning that routine travel patterns (eg. school/work-related travel) peak at those hours. In September, some regions have holidays (eg. Labor Day), which potentially reduces Monday traveling. In November, average boardings seem lower on Wednesdays, Thursdays, and Fridays due to Thanksgiving, which can lead to reduced local commuting.

## Part 2
```{r}
ggplot(capmetro_UT) + geom_jitter(aes(x = temperature, y = boarding, color = weekend)) + facet_wrap(~hour_of_day) + theme_classic() + labs(
    title = "Total Number of Bike Rentals in Different Temperatures of the Day During Different Hours of the Day Among Weekdays or Weekends",
    x = "Temperatures",
    y = "Number of Boardings")
```

The scatter plot shows the the number of boardings during the weekdays or weekends among the hour of the day at different temperatures.

When weekend status and hour of day are both held constant, there are not a lot of people boarding the bus when the temperature is too low or too high.


# Problem 4

## Part A
```{r}
billb %>%
  group_by(performer, song) %>%
  summarize(count = n(), .groups = "drop") %>%
  arrange(desc(count)) %>%
  head(10)
```

This table shows the top 10 songs on Billboard Top 100.


## Part B
```{r}
top_100 <- filter(billb, year != 1958, year != 2021)
top_100 <- top_100[, c("year", "song_id")]
top100_unique <- unique(top_100)
diversity <- top100_unique %>%
  group_by(year) %>%
  summarize(unique_songs = n())
ggplot(diversity) + geom_line(aes(x = year, y = unique_songs)) + theme_classic() + labs(
    title = "The Number of Unique Songs in the Billboard Top 100 Over the Years",
    x = "Year",
    y = "Number of Unique Songs")
```

Number of unique songs appearing at any position on the Billboard Top 100 chart in any week in a year. 

According to this line graph, the number of unique songs on the Billboard Top 100 peaked in the mid-1960s, and then rapidly declined until around 2003. Then, it started to rapidly increase again, reaching a level near the mid-60s peak in 2020.

## Part C
```{r}
top_artists <- billb %>%
  filter(weeks_on_chart >= 10) %>%
  group_by(performer) %>%         
  summarize(ten_week_hits = n_distinct(song))
top_artists <- filter(top_artists, ten_week_hits >= 30) 
table <- arrange(top_artists, desc(ten_week_hits))    

ggplot(top_artists) +
  geom_bar(aes(x = performer, y = ten_week_hits), stat = "identity", fill = "steelblue") +
  theme_classic() +
  labs(
    title = "Artists with at Least 30 Ten-Week Hits",
    x = "Artist",
    y = "Number of Ten-Week Hits"
  ) + coord_flip()
```

The number of ten-week hits among the artists with at least 30 ten-week hits